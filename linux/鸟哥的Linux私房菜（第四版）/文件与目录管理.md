# 一些特殊的目录

| 符号       | 含义                                          |
| ---------- | --------------------------------------------- |
| `.`        | 当前目录                                      |
| `..`       | 上一层目录                                    |
| `-`        | 前一个工作目录                                |
| `~`        | home目录。/home/abc或/root。                  |
| `~account` | accout用户的home目录（account是一个账户名称） |



# 创建、移除目录(mkdir,rmdir)

| 命令    | 作用               |
| ------- | ------------------ |
| `cd`    | 切换工作目录       |
| `pwd`   | 显示当前目录       |
| `mkdir` | 建立一个空目录     |
| `rmdir` | **移除一个空目录** |



- pwd命令：使用可选参数`-P`可以显示真正的路径，而非链接路径。

- mkdir：

  ```
  用法：mkdir [选项]... 目录...
  若 <目录> 不存在，则创建 <目录>。
  
  长选项的必选参数对于短选项也是必选的。
    -m, --mode=模式   设置文件模式（格式同 chmod），而不是 a=rwx - umask
    -p, --parents     需要时创建目标目录的父目录，但即使这些目录已存在
                      也不视为错误，且其文件模式也不受 -m 选项影响。
    -v, --verbose     每次创建新目录时，打印一条消息
    -Z                   将每个创建的目录的 SELinux 安全上下文设置为默认类型
        --context[=上下文]  类似 -Z，但如果指定了 <上下文>，则将 SELinux
                              或 SMACK 安全上下文设置为 <上下文>
        --help        显示此帮助信息并退出
        --version     显示版本信息并退出
  ```

  > 目录的默认权限，与umask有关。



# \$PATH

当执行一个命令时（例如ls），系统会依据PATH的设置，去每个PATH定义的目录下查找名为ls的可执行文件。

> 如果存在多个同名为ls的可执行文件，则先查找到的被执行。



例如：

```sh
echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl
```

目录与目录之间，采用`:`分隔。



将路径加入PATH：
```sh
PATH="${PATH}:dir""
```

例如：

```sh
PATH="${PATH}:/root"
```



注意：
==`.`不应该存在于PATH中==，因此需要执行当前目录中的命令时，应使用：

```sh
./a.out
```



# 文件与目录的查看(ls)

用于查看文件或目录的属性。

> 在Linxu中，与权限、属性相关的数据，都放在了inode里。

.

最常用的是：

```sh
ls -l
总计 52
-rwxr-xr-x 1 gxy gxy 21144  9月11日 11:28 a.out
drwxr-xr-x 2 gxy gxy  4096  9月11日 11:09 f
-rw-r--r-- 1 gxy gxy  8688  9月11日 12:10 ls.txt
-rw-r--r-- 1 gxy gxy    91  9月11日 11:28 main.cpp
-rw-r--r-- 1 gxy gxy    99  9月11日 11:19 path.txt
-rwxrwxrwx 1 gxy gxy     8  9月11日 09:13 test.txt
```



# 复制、删除、移动（cp,rm,mv）

> 6.2.2节



- cp命令：

  1. 复制文件
  2. 建立链接文件（快捷方式）
  3. 比对两文件的新旧而予以更新
  4. 复制整个目录

  常用选项：
  `-i`,`-p`,`-r`

- mv命令：

  1. 移动文件
  2. 重命名文件

- rm命令：

  1. 删除文件



# 查看文件内容(cat,tac,nl)

- cat，由第一行开始显示文件内容(concatenate)
- tac，从最后一行开始显示
- nl，显示的时候，同时输出行号
- more，一页一页地显示文件内容
- less，类似于more，但可以向前翻页
- hade，只看前几行
- tail，只看末尾几行
- od，以二进制格式读取文件内容





## 数据截取(head,tail,less,more)

- head：
  - `head`默认取前10行
  - `head -n 2 test.txt`：截取前两行
  - `head -n -100 test.txt`：截取除最后100行的内容
- tail：
  - `tail`默认取最后10行
  - `tail -n 2 test.txt`：最后两行
  - `tail -n +100 test.txt`：第100行之后的内容
  - `tail -f /var/log/messages`：当文件有数据写入时，就显示到屏幕上，直到Ctrl+C。



==管道符`|`：将前面命令所输出的内容，通过管道交由后续的命令继续使用==。

例如：截取第11行到20行：
```sh
head -n 20 test.txt | tail -n 10
```



## 非纯文本文件：od

```sh
od [-t TYPE] 文件
```

支持的TYPE：

- a：使用默认的字符来输出

- c：使用ASCII字符输出

- d[size]：使用十进制数来数组，每个整数占用size字节

- f[size]：浮点数值

- o[size]：八进制

- x[size]：十六进制

  >其中size，可以使用：C 代表 sizeof(char)、S 代表 sizeof(short)、I 代表 sizeof(int)，或 L 代表 sizeof(long)。





例如：

```sh
echo abc | od -toCc > od.test
0000000 141 142 143 012
          a   b   c  \n
0000004
```



# 修改文件时间或创建新文件（touch)

- 修改时间（modification time, mtime）：

  当文件的内容数据被更改时。

- 状态时间（status time, ctime）：

  当文件的状态（权限、属性）改变时。

- 读取时间（acess time, atime）：

  当文件内容被读取时。

```sh
ls -l test.txt;\
ls -l --time=atime test.txt;\
ls -l --time=ctime test.txt
```

> 即默认是mtime。



```sh
touch [-acdmt]文件
-a：仅自定义access time
-c：仅修改文件的时间，若该文件不存在则不建立新文件
-d：使用自定义的时间而非当前时间
-m：仅修改mtime
-t：使用自定义的时间，格式为[YYYYMMDDhhmm]
```



# 文件与目录的默认权限与隐藏权限

除了基本的rwx权限外，在Linux的ext2，ext3，ext4文件系统下，还可以设置一些系统隐藏属性。

以`chattr`来设置，以`lsattr`来查看。



## 文件/目录默认权限：umask

==umask，即为当前用户在建立文件或目录时的默认权限==。



```sh
[gxy@arch test]$ umask
0022
[gxy@arch test]$ umask -S
u=rwx,g=rx,o=rx
```



==创建文件/目录时的权限=默认完全权限 - umask==。

- 文件默认完全权限：666

  > 即新建文件的权限为644，`-rw-r--r--`

- 目录默认完全权限：777

  > 即新建陌路的权限为755，`drwxr-xr-x`



注意，其中的`-`，代表的是位的逻辑运算。

例如：666-003$\neq$663，因为原先的权限为rw-，减去权限-wx，结果应为r--。

>- root用户的umask，默认是022。
>- 一般用户的umask，默认是002。



## 文件隐藏权限

> 6.4.2节

例如：

- 对文件的修改，以同步的方式立刻写入磁盘
- 只能增加数据、不能删除或修改数据
- ...



## 文件特殊权限-SUID、SGID、SBIT

- SUID：

  当标志s，出现在文件拥有者的x权限上时，称之为Set UID，简称为SUID的特殊权限。

  例如：/usr/bin/passwd这个文件的权限为[-rwsr-xr-x]。

  SUID的限制与功能：

  1. SUID权限，仅对二进制程序有效

  2. 执行者，需要对该程序具有x权限

  3. 本权限仅在执行该程序的过程中有效

  4. 执行者在运行时将具有该程序的owner的权限。

     > ==即程序运行为进程时，进程的属主不是发起者，而是程序文件所属的属主==。

  ![image-20220912192542806](%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E7%AE%A1%E7%90%86.assets/image-20220912192542806-1662981942975-1.png)

  因此，当具有x权限的一般用户，执行passwd命令时，将获得owner的权限，而owner(root)对/etc/shadow文件具有修改的权限，从而间接对该文件进行修改。

- SGID：

  当标志s，出现在用户组的x权限上时，称之为Set GID，简称为SGID的特殊权限。

  SGID设置在目录或文件上，具有不同的效果。

  > 参见6.4.3节，P199

- SBIT：

  当标志t，出现在其他用户的权限上时，即SBIT权限。

  - SBIT权限，只能对目录进行设置。

  - SBIT权限的功能：

    - 用户需要对此目录具有wx权限，即写入的权限；
    - 当用户在此目录下创建文件时，仅有自己和root可删除该文件。

    > 即，在未对目录设置SBIT权限时，任何具有组或其他人身份的w权限的用户，均可删除、移动、更名该文件夹下的文件；但在设置SBIT权限后，仅有自己和root可仅对文件进行操作。



如何设置这三个权限：在代表rwx权限的三个数字前，再添加一个数组

- 4为SUID
- 2为SGID
- 1为SBIT

例如：将一文件的权限修改为[-rwsr-xr-x]，即chmod 4755 filename。



# 观察文件类型（file)

可用于查看某个文件的基本信息，如是否属于ASCII/数据文件/二进制文件，是否使用到动态链接库等。



# 命令与文件的查找

## 脚本文件(命令)的查找

which命令：

将根据$PATH这个环境变量所规范的路径，去查找执行文件的文件名。

> 如history等命令，是bash内置的命令，which命令可能找不到。



## 文件的查找

- `whereis`：在一些特定的目录中查找文件：

  通过`whereis -l`可以列出将要查找的路径

- `locate/updatedb`：

  1. 支持输入文件的部分名称

  2. 是基于建立的索引数据库/var/lib/mlocate查找的

     > 数据的更新一般是一天一次。
     >
     > 可手动更新：updatedb命令，将根据/etc/updatedb/conf的设置，去更新索引数据库文件。

- `find`：

  特别的，可以指定时间上的限制、指定用户和所属组、指定权限等。

  > 见6.5.1节，P203

