```cmake
CMAKE_MINIMUM_REQUIRED(VERSION 3.25.0)
include(CMakeDependentOption)

project(Demo)

# cmake -DUSE_LIBRARY=ON
option(USE_LIBRARY "Compiles sources into a library" OFF)
message(STATUS "Complie sources into a library? ${USE_LIBRARY}")

# 仅当变量USE_LIBRARY为真时生效，否则此选项无意义
cmake_dependent_option(
    MAKE_STATIC_LIBRARY "Compile sources into a static library" OFF # 将MAKE_STATIC_LIBRARY变量设置为默认OFF
    "USE_LIBRARY" ON
)
cmake_dependent_option(
    MAKE_SHARED_LIBRARY "Compile sources into a shared library" ON
    "USE_LIBRARY" ON
)

list(APPEND _sources Message.cpp Message.hpp)

if(USE_LIBRARY)
    add_library(message ${_sources})
    add_executable(main main.cpp)
    target_link_libraries(main message)
else()
    add_executable(main main.cpp ${_sources})
endif()
```



```sh
cmake -S. -B./build -G Ninja -DUSE_LIRARY=ON
```

![image-20221106184905085](%E5%90%91%E7%94%A8%E6%88%B7%E6%98%BE%E7%A4%BA%E9%80%89%E9%A1%B9.assets/image-20221106184905085.png)